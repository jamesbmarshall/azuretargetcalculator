<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Cloud Target Calculator | Optimize Revenue Growth</title>
  <meta name="description" content="Cloud Target Calculator helps you forecast revenue, optimize customer acquisition, and track growth trends effectively.">
  <meta name="keywords" content="Cloud Calculator, Revenue Growth, Customer Acquisition, Business Analytics, SaaS Metrics">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Open Graph Meta Tags for SEO -->
  <meta property="og:title" content="Cloud Target Calculator | Optimize Revenue Growth">
  <meta property="og:description" content="Cloud Target Calculator helps you forecast revenue, optimize customer acquisition, and track growth trends effectively.">
  <meta property="og:image" content="https://example.com/preview-image.jpg">
  <meta property="og:url" content="https://example.com/cloud-target-calculator">
  <meta name="twitter:card" content="summary_large_image">

  <!-- Schema Markup for SEO -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "SoftwareApplication",
    "name": "Cloud Target Calculator",
    "description": "Predict customer acquisition, churn, and revenue growth.",
    "applicationCategory": "BusinessApplication",
    "operatingSystem": "All",
    "author": {
      "@type": "Person",
      "name": "James Marshall"
    }
  }
  </script>

  <!-- Import Open Sans from Google Fonts for a modern look -->
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">

  <!-- Tailwind CSS for Utility-First Styling -->
  <script src="https://cdn.tailwindcss.com" defer></script>

  <!-- Include Plotly (deferred for performance) -->
  <script src="https://cdn.plot.ly/plotly-latest.min.js" defer></script>

  <!-- Optional external stylesheet for additional custom styles -->
  <link rel="stylesheet" href="style.css">

  <style>
    /* Provide aria-label for chart containers to improve accessibility */
    #waterfallChart,
    #funnelChart {
      aria-label: "Data Visualization";
      role: region;
    }

    /* Buttons aria-label (optional) */
    #advancedToggle {
      aria-label: "Toggle Advanced Options";
    }
    #toggleDetails {
      aria-label: "Toggle Detailed Columns";
    }

    /* Inset box-shadow for focus to prevent clipping if overflow is hidden */
    button:focus,
    input:focus,
    select:focus {
      outline: none;
      box-shadow: inset 0 0 0 2px #0078d4;
    }

    /* Collapsible form approach using .collapsed / .expanded classes */
    #calcForm {
      overflow: hidden;
      transition: max-height 0.5s ease;
    }
    #calcForm.collapsed {
      max-height: 0;
    }
    #calcForm.expanded {
      max-height: 9999px; /* arbitrarily large to accommodate all fields */
    }

    /* Hide advanced options by default, show via JS */
    #advancedOptions {
      display: none;
    }
  </style>
</head>

<body class="bg-gradient-to-r from-[#0078d4] to-[#74ebd5] p-5 font-[Open Sans] text-[#333] leading-relaxed">
  <!-- Main Container -->
  <div class="max-w-screen-xl mx-auto">
    <!-- Form Bubble -->
    <section class="bubble bg-white rounded-lg shadow-md mb-6 p-6 relative">
      <h1 class="text-2xl font-bold mb-2">Cloud Revenue Target Calculator v2</h1>
      <p class="mb-4">
        Fill in the form below to get insights into the number of customers or the consumption growth you'll need to hit your overall targets.
        Use advanced options to adjust your lead conversion rates.
      </p>

      <!-- Collapsible Form -->
      <!-- Default to .expanded so it’s open on load; JS can auto-collapse if needed -->
      <form id="calcForm" class="transition-max-height duration-500 expanded">
        <!-- Fieldset for main metrics -->
        <fieldset class="mb-4">
          <legend class="font-semibold mb-2">Key Revenue Inputs</legend>

          <label class="block mb-2 font-semibold" for="months">Months in Scope:</label>
          <input type="number" id="months" value="12" min="1" step="any" required
                 class="w-full max-w-md p-2 border border-gray-300 rounded mb-4" />

          <label class="block mb-2 font-semibold" for="targetSpend">Target Spend per Customer, per Month:</label>
          <input type="number" id="targetSpend" value="1000" min="1" step="any" required
                 class="w-full max-w-md p-2 border border-gray-300 rounded mb-4" />

          <label class="block mb-2 font-semibold" for="ramp">Ramp-up Period in Months:</label>
          <input type="number" id="ramp" value="1" min="1" step="any" required
                 class="w-full max-w-md p-2 border border-gray-300 rounded mb-4" />

          <label class="block mb-2 font-semibold" for="growth">Organic Growth Rate per Month [as %]:</label>
          <input type="number" id="growth" value="0" min="0" step="any" required
                 class="w-full max-w-md p-2 border border-gray-300 rounded mb-4" />

          <label class="block mb-2 font-semibold" for="churn">Revenue Churn Rate per Month [as %]:</label>
          <input type="number" id="churn" value="0" min="0" step="any" required
                 class="w-full max-w-md p-2 border border-gray-300 rounded mb-4" />

          <label class="block mb-2 font-semibold" for="targetRevenue">Total Revenue Target:</label>
          <input type="number" id="targetRevenue" value="78000" min="1" step="any" required
                 class="w-full max-w-md p-2 border border-gray-300 rounded mb-4" />

          <label class="block mb-2 font-semibold" for="baseline">Baseline Recurring Revenue per Month:</label>
          <input type="number" id="baseline" value="0" min="0" step="any" required
                 class="w-full max-w-md p-2 border border-gray-300 rounded mb-4" />

          <label class="block mb-2 font-semibold" for="pctAcq">% of Additional Revenue from New Customers (Acquisition):</label>
          <input type="number" id="pctAcq" value="50" min="0" max="100" step="any" required
                 class="w-full max-w-md p-2 border border-gray-300 rounded mb-4" />
        </fieldset>

        <!-- Seasonality Inputs -->
        <fieldset class="mb-4">
          <legend class="font-semibold mb-2">Seasonality</legend>

          <label class="block mb-2 font-semibold" for="startMonth">Plan Start Month:</label>
          <select id="startMonth"
                  class="w-full max-w-md p-2 border border-gray-300 rounded mb-4">
            <option value="0">January</option>
            <option value="1">February</option>
            <option value="2">March</option>
            <option value="3">April</option>
            <option value="4">May</option>
            <option value="5">June</option>
            <option value="6">July</option>
            <option value="7">August</option>
            <option value="8">September</option>
            <option value="9">October</option>
            <option value="10">November</option>
            <option value="11">December</option>
          </select>

          <label class="block mb-2 font-semibold" for="startYear">Plan Start Year:</label>
          <input type="number" id="startYear" value="2025" min="2000" step="1" required
                 class="w-full max-w-md p-2 border border-gray-300 rounded mb-4" />

          <label class="inline-flex items-center cursor-pointer mb-4">
            <input type="checkbox" id="seasonalToggle" checked
                   class="mr-2" />
            <span class="font-semibold">Use Seasonal Adjustments</span>
          </label>
        </fieldset>

        <!-- Advanced Options Toggle -->
        <button type="button" id="advancedToggle"
                class="bg-orange-500 hover:bg-orange-600 text-white py-2 px-4 rounded mb-2"
                aria-label="Toggle Advanced Options">
          Advanced Options
        </button>
        <fieldset id="advancedOptions" class="bg-gray-50 border border-gray-200 rounded p-4 mb-4" style="display:none;">
          <legend class="font-semibold mb-2">Advanced Conversion Inputs</legend>

          <label class="block mb-2 font-semibold" for="mqlPerSql">MQLs per SQL:</label>
          <input type="number" id="mqlPerSql" value="5" min="0" step="any"
                 class="w-full max-w-md p-2 border border-gray-300 rounded mb-4" />

          <label class="block mb-2 font-semibold" for="sqlPerWin">SQLs per Win:</label>
          <input type="number" id="sqlPerWin" value="3" min="0" step="any"
                 class="w-full max-w-md p-2 border border-gray-300 rounded mb-4" />
        </fieldset>

        <button type="submit"
                class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded">
          Calculate
        </button>
      </form>

      <!-- Form Toggle Handle -->
      <div id="formToggleHandle"
           class="text-center mt-4 bg-blue-100 text-blue-600 rounded-b-lg p-2 font-semibold cursor-pointer">
        ⬆️ Hide Form
      </div>
    </section>

    <!-- Results Bubble -->
    <section class="bubble bg-white rounded-lg shadow-md mb-6 p-6 relative" id="resultsContainer">
      <!-- Toggle Detailed Columns -->
      <button type="button" id="toggleDetails"
              class="bg-gray-600 hover:bg-gray-700 text-white py-2 px-4 rounded mb-4"
              aria-label="Toggle Detailed Columns">
        Show Detailed Columns
      </button>
      <button id="shareBtn" class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded">
        Share
      </button>
      <!-- Container for the dynamic results table -->
      <div class="table-responsive overflow-x-auto" id="resultsTable"></div>
      <!-- Container for the waterfall chart -->
      <div class="chart-responsive overflow-x-auto mt-6">
        <div id="waterfallChart"
             style="height: 400px;"
             role="region"
             aria-label="Revenue Waterfall Chart showing monthly revenue contributions">
        </div>
      </div>
    </section>

    <!-- Marketing Funnel Bubble -->
    <section class="bubble bg-white rounded-lg shadow-md mb-6 p-6 relative" id="funnelContainer">
      <h2 class="text-xl font-semibold mb-2">Marketing Funnel</h2>
      <p class="mb-4">
        This is the breakdown of marketing qualified leads, to sales qualified leads, to wins based on a default of 5:3:1,
        or your own conversion if you've changed any advanced options.
      </p>
      <div class="chart-responsive overflow-x-auto">
        <div id="funnelChart"
             style="height: 400px;"
             role="region"
             aria-label="Funnel Chart showing lead-to-win conversion rates">
        </div>
      </div>
      <div class="table-responsive overflow-x-auto mt-4" id="funnelTable"></div>
    </section>
  </div>

  <!-- Footer Section -->
  <footer>
    © 2025 James Marshall. All rights reserved.
  </footer>

  <!-- Main JS for calculations (defer or load at bottom for performance) -->
  <script src="app.js" defer></script>
</body>
</html>